{"ast":null,"code":"import{useEffect,useState}from\"react\";import axios from\"axios\";import{Link}from\"react-router-dom\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BlogList=()=>{const[blogs,setBlogs]=useState([]);const[userId,setUserId]=useState(localStorage.getItem(\"userId\"));// Initialize userId correctly\nuseEffect(()=>{fetchBlogs();},[]);const fetchBlogs=async()=>{try{const response=await axios.get(\"https://mern-blog-2-1ko4.onrender.com/blogs\");setBlogs(response.data);}catch(error){console.error(\"Error fetching blogs:\",error);}};const handleDelete=async blogId=>{if(!userId){alert(\"User not logged in!\");return;}try{const response=await fetch(`https://mern-blog-2-1ko4.onrender.com/blogs/${blogId}`,{method:\"DELETE\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({userId})});const data=await response.json();if(response.ok){alert(\"Blog deleted successfully!\");setBlogs(blogs.filter(blog=>blog._id!==blogId));// Remove deleted blog from state\n}else{alert(\"Error: \"+data.error);}}catch(error){console.error(\"Error deleting blog:\",error);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-5xl mx-auto px-4 py-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-800 text-center mb-6\",children:\"Latest Blogs\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4\",children:blogs.map(blog=>{var _blog$sections,_blog$sections$,_blog$comments;return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white shadow-md rounded-lg overflow-hidden transition-transform transform hover:scale-105 text-sm w-[280px] mx-auto\",children:[blog.image&&/*#__PURE__*/_jsx(\"img\",{src:`http://localhost:4000${blog.image}`,alt:blog.title,className:\"w-full h-36 object-cover\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-3\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-base font-semibold text-gray-900 mb-1\",children:blog.title}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600 text-xs mb-2\",children:[\"By \",blog.author]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700 mb-3 line-clamp-2\",children:(_blog$sections=blog.sections)!==null&&_blog$sections!==void 0&&(_blog$sections$=_blog$sections[0])!==null&&_blog$sections$!==void 0&&_blog$sections$.paragraph?blog.sections[0].paragraph.slice(0,80)+\"...\":\"No content available.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center text-gray-500 text-xs\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u2764\\uFE0F \",blog.likes||0,\" Likes\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\uD83D\\uDCAC \",((_blog$comments=blog.comments)===null||_blog$comments===void 0?void 0:_blog$comments.length)||0,\" Comments\"]})]}),/*#__PURE__*/_jsx(Link,{to:`/blogs/${blog._id}`,className:\"block mt-2 text-blue-500 font-medium text-center hover:text-blue-600\",children:\"Read More \\u2192\"}),userId===blog.authorId&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDelete(blog._id),className:\"mt-3 w-full bg-red-500 text-white py-1 rounded hover:bg-red-600 transition\",children:\"Delete Blog\"})]})]},blog._id);})})]});};export default BlogList;","map":{"version":3,"names":["useEffect","useState","axios","Link","jsx","_jsx","jsxs","_jsxs","BlogList","blogs","setBlogs","userId","setUserId","localStorage","getItem","fetchBlogs","response","get","data","error","console","handleDelete","blogId","alert","fetch","method","headers","body","JSON","stringify","json","ok","filter","blog","_id","className","children","map","_blog$sections","_blog$sections$","_blog$comments","image","src","alt","title","author","sections","paragraph","slice","likes","comments","length","to","authorId","onClick"],"sources":["C:/Users/Administrator/Desktop/mern-blog/frontend/src/components/BlogList.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nconst BlogList = () => {\r\n  const [blogs, setBlogs] = useState([]);\r\n  const [userId, setUserId] = useState(localStorage.getItem(\"userId\")); // Initialize userId correctly\r\n\r\n  useEffect(() => {\r\n    fetchBlogs();\r\n  }, []);\r\n\r\n  const fetchBlogs = async () => {\r\n    try {\r\n      const response = await axios.get(\"https://mern-blog-2-1ko4.onrender.com/blogs\");\r\n      setBlogs(response.data);\r\n    } catch (error) {\r\n      console.error(\"Error fetching blogs:\", error);\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (blogId) => {\r\n    if (!userId) {\r\n      alert(\"User not logged in!\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await fetch(`https://mern-blog-2-1ko4.onrender.com/blogs/${blogId}`, {\r\n        method: \"DELETE\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ userId }),\r\n      });\r\n\r\n      const data = await response.json();\r\n      if (response.ok) {\r\n        alert(\"Blog deleted successfully!\");\r\n        setBlogs(blogs.filter((blog) => blog._id !== blogId)); // Remove deleted blog from state\r\n      } else {\r\n        alert(\"Error: \" + data.error);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error deleting blog:\", error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-5xl mx-auto px-4 py-8\">\r\n      <h2 className=\"text-2xl font-bold text-gray-800 text-center mb-6\">\r\n        Latest Blogs\r\n      </h2>\r\n\r\n      {/* Blog Grid */}\r\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4\">\r\n        {blogs.map((blog) => (\r\n          <div\r\n            key={blog._id}\r\n            className=\"bg-white shadow-md rounded-lg overflow-hidden transition-transform transform hover:scale-105 text-sm w-[280px] mx-auto\"\r\n          >\r\n            {/* Blog Image */}\r\n            {blog.image && (\r\n              <img\r\n                src={`http://localhost:4000${blog.image}`}\r\n                alt={blog.title}\r\n                className=\"w-full h-36 object-cover\"\r\n              />\r\n            )}\r\n\r\n            {/* Blog Content */}\r\n            <div className=\"p-3\">\r\n              <h3 className=\"text-base font-semibold text-gray-900 mb-1\">\r\n                {blog.title}\r\n              </h3>\r\n              <p className=\"text-gray-600 text-xs mb-2\">By {blog.author}</p>\r\n\r\n              {/* Blog Preview */}\r\n              <p className=\"text-gray-700 mb-3 line-clamp-2\">\r\n                {blog.sections?.[0]?.paragraph\r\n                  ? blog.sections[0].paragraph.slice(0, 80) + \"...\"\r\n                  : \"No content available.\"}\r\n              </p>\r\n\r\n              {/* Likes & Comments */}\r\n              <div className=\"flex justify-between items-center text-gray-500 text-xs\">\r\n                <p>‚ù§Ô∏è {blog.likes || 0} Likes</p>\r\n                <p>üí¨ {blog.comments?.length || 0} Comments</p>\r\n              </div>\r\n\r\n              {/* Read More Button */}\r\n              <Link\r\n                to={`/blogs/${blog._id}`}\r\n                className=\"block mt-2 text-blue-500 font-medium text-center hover:text-blue-600\"\r\n              >\r\n                Read More ‚Üí\r\n              </Link>\r\n\r\n              {/* Show Delete Button Only if Logged-in User is the Author */}\r\n              {userId === blog.authorId && (\r\n                <button\r\n                  onClick={() => handleDelete(blog._id)}\r\n                  className=\"mt-3 w-full bg-red-500 text-white py-1 rounded hover:bg-red-600 transition\"\r\n                >\r\n                  Delete Blog\r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BlogList;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}